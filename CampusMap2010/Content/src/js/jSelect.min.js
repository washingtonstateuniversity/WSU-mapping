/*! jSelect 0.0.1 2014-12-05 */
/*   */
!function(a){var b=0,c=a(document);a.widget("ui.jselect",{options:{header:!0,height:175,minWidth:225,classes:"",checkAllText:"Check all",uncheckAllText:"Uncheck all",noneSelectedText:"Select options",allSelectedText:"All selected",selectedText:"# selected",selectedList:0,closeIcon:"ui-icon-circle-close",show:null,hide:null,autoOpen:!1,multiple:!0,selectOnSpace:!1,bShowAllSelectedText:!1,position:{},appendTo:"body",menuWidth:null},_create:function(){var c=this.element.hide(),d=this.options;this.speed=a.fx.speeds._default,this._isOpen=!1,this._namespaceID=this.eventNamespace||"jselect"+b;var e=(this.button=a('<button type="button"><span class="ui-icon ui-icon-triangle-1-s"></span></button>')).addClass("jselect ui-widget ui-state-default ui-corner-all").addClass(d.classes).attr({title:c.attr("title"),"aria-haspopup":!0,tabIndex:c.attr("tabIndex")}).insertAfter(c);(this.buttonlabel=a("<span />")).html(d.noneSelectedText).appendTo(e);var f=(this.menu=a("<div />")).addClass("jselect-menu ui-widget ui-widget-content ui-corner-all").addClass(d.classes).appendTo(a(d.appendTo)),g=(this.header=a("<div />")).addClass("ui-widget-header ui-corner-all jselect-header ui-helper-clearfix").appendTo(f);(this.headerLinkContainer=a("<ul />")).addClass("ui-helper-reset").html(function(){return d.header===!0?'<li><a class="jselect-all" href="#"><span class="ui-icon ui-icon-check"></span><span>'+d.checkAllText+'</span></a></li><li><a class="jselect-none" href="#"><span class="ui-icon ui-icon-closethick"></span><span>'+d.uncheckAllText+"</span></a></li>":"string"==typeof d.header?"<li>"+d.header+"</li>":""}).append('<li class="jselect-close"><a href="#" class="jselect-close"><span class="ui-icon '+d.closeIcon+'"></span></a></li>').appendTo(g),(this.checkboxContainer=a("<ul />")).addClass("jselect-checkboxes ui-helper-reset").appendTo(f),this._bindEvents(),this.refresh(!0),d.multiple||f.addClass("jselect-single"),b++},_init:function(){this.options.header===!1&&this.header.hide(),this.options.multiple||this.headerLinkContainer.find(".jselect-all, .jselect-none").hide(),this.options.autoOpen&&this.open(),this.element.is(":disabled")&&this.disable()},refresh:function(c){var d=this.element,e=this.options,f=this.menu,g=this.checkboxContainer,h=[],i="",j=d.attr("id")||b++;a.each(d.find("option"),function(b){var c,d=this.parentNode,f=a(this).data("image"),g=this.innerHTML,k=this.title,l=this.value,m="jselect-"+(this.id||j+"-option-"+b),n=this.disabled,o=this.selected,p=["ui-corner-all"],q=(n?"jselect-disabled ":"")+this.className+(f?" jselect-img ":"");"OPTGROUP"===d.tagName&&(c=d.getAttribute("label"),-1===a.inArray(c,h)&&(i+='<li class="jselect-optgroup-label '+d.className+'"><a href="#">'+c+"</a></li>",h.push(c))),n&&p.push("ui-state-disabled"),o&&!e.multiple&&p.push("ui-state-active"),i+='<li class="'+q+'">',i+='<label for="'+m+'" title="'+k+'" class="'+p.join(" ")+'">',i+='<input id="'+m+'" name="jselect_'+j+'" type="'+(e.multiple?"checkbox":"radio")+'" value="'+l+'" title="'+k+'"',o&&(i+=' checked="checked"',i+=' aria-selected="true"'),n&&(i+=' disabled="disabled"',i+=' aria-disabled="true"'),i+=" /><span>",f&&(i+='<img src="'+f+'" />'),i+=g+"</span></label></li>"}),g.html(i),this.labels=f.find("label"),this.inputs=this.labels.children("input"),this._setButtonWidth(),this._setMenuWidth(),this.button[0].defaultValue=this.update(),c||this._trigger("refresh")},update:function(){var b,c=this.options,d=this.inputs,e=d.filter(":checked"),f=d.length,g=e.length;return b=0===g?c.noneSelectedText:g===f&&c.bShowAllSelectedText?c.allSelectedText:a.isFunction(c.selectedText)?c.selectedText.call(this,g,d.length,d.filter(":not(:disabled)").length,e.get()):/\d/.test(c.selectedList)&&c.selectedList>0&&g<=c.selectedList?e.map(function(){return a(this).next().html()}).get().join(", "):c.selectedText.replace("#",g).replace("#",d.length),this._setButtonValue(b),b},_setButtonValue:function(a){this.buttonlabel.text(a)},_bindEvents:function(){function b(){return d[d._isOpen?"close":"open"](),!1}var d=this,e=this.button;e.find("span").bind("click.jselect",b),e.bind({click:b,keypress:function(a){switch(a.which){case 27:case 38:case 37:d.close();break;case 39:case 40:d.open()}},mouseenter:function(){e.hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover")},mouseleave:function(){a(this).removeClass("ui-state-hover")},focus:function(){e.hasClass("ui-state-disabled")||a(this).addClass("ui-state-focus")},blur:function(){a(this).removeClass("ui-state-focus")}}),this.header.delegate("a","click.jselect",function(b){a(this).hasClass("jselect-close")?d.close():d[a(this).hasClass("jselect-all")?"checkAll":"uncheckAll"](),b.preventDefault()}),this.menu.delegate("li.jselect-optgroup-label a","click.jselect",function(b){b.preventDefault();var c=a(this),e=c.parent().nextUntil("li.jselect-optgroup-label").find("input:visible:not(:disabled)"),f=e.get(),g=c.parent().text();d._trigger("beforeoptgrouptoggle",b,{inputs:f,label:g})!==!1&&(d._toggleChecked(e.filter(":checked").length!==e.length,e),d._trigger("optgrouptoggle",b,{inputs:f,label:g,checked:f[0].checked}))}).delegate("label","mouseenter.jselect",function(){a(this).hasClass("ui-state-disabled")||(d.labels.removeClass("ui-state-hover"),a(this).addClass("ui-state-hover").find("input").focus())}).delegate("label","keydown.jselect",function(b){switch(b.preventDefault(),b.which){case 9:case 27:d.close();break;case 38:case 40:case 37:case 39:d._traverse(b.which,this);break;case 13:a(this).find("input")[0].click();break;case 32:d.options.selectOnSpace===!0&&a(this).find("input")[0].click()}}).delegate("label","keyup.jselect",function(a){d.options.selectOnSpace===!0&&a.preventDefault()}).delegate('input[type="checkbox"], input[type="radio"]',"click.jselect",function(b){var c=a(this),e=this.value,f=this.checked,g=d.element.find("option");return this.disabled||d._trigger("click",b,{value:e,text:this.title,checked:f})===!1?void b.preventDefault():(c.focus(),c.attr("aria-selected",f),g.each(function(){this.value===e?this.selected=f:d.options.multiple||(this.selected=!1)}),d.options.multiple||(d.labels.removeClass("ui-state-active"),c.closest("label").toggleClass("ui-state-active",f),d.close()),d.element.trigger("change"),void window.setTimeout(a.proxy(d.update,d),10))}),c.bind("mousedown."+this._namespaceID,function(b){var c=b.target;!d._isOpen||c===d.button[0]||c===d.menu[0]||a.contains(d.menu[0],c)||a.contains(d.button[0],c)||d.close()}),a(this.element[0].form).bind("reset.jselect",function(){window.setTimeout(a.proxy(d.refresh,d),10)})},_setButtonWidth:function(){var a=this.element.outerWidth(),b=this.options;"auto"===b.minWidth?a=b.minWidth:/\d(%|em)/.test(b.minWidth)?a=b.minWidth:/\d/.test(b.minWidth)&&a<b.minWidth&&(a=b.minWidth),this.button.outerWidth(a)},_setMenuWidth:function(){var a=this.menu;a.outerWidth(this.options.menuWidth||this.button.outerWidth())},_traverse:function(b,c){var d=a(c),e=38===b||37===b,f=d.parent()[e?"prevAll":"nextAll"]("li:visible:not(.jselect-disabled, .jselect-optgroup-label)").first();if(f.length)f.find("label").trigger("mouseover");else{var g=this.menu.find("ul").last();this.menu.find("label")[e?"last":"first"]().trigger("mouseover"),g.scrollTop(e?g.height():0)}},_toggleState:function(a,b){return function(){this.disabled||(this[a]=b),b?this.setAttribute("aria-selected",!0):this.removeAttribute("aria-selected")}},_toggleChecked:function(b,c){var d=c&&c.length?c:this.inputs,e=this;d.each(this._toggleState("checked",b)),d.eq(0).focus(),this.update();var f=d.map(function(){return this.value}).get();this.element.find("option").each(function(){!this.disabled&&a.inArray(this.value,f)>-1&&e._toggleState("selected",b).call(this)}),d.length&&this.element.trigger("change")},_toggleDisabled:function(b){this.button.attr({disabled:b,"aria-disabled":b})[b?"addClass":"removeClass"]("ui-state-disabled");var c=this.menu.find("input"),d="ui-jselect-disabled";c=b?c.filter(":enabled").data(d,!0):c.filter(function(){return a.data(this,d)===!0}).removeData(d),c.attr({disabled:b,"arial-disabled":b}).parent()[b?"addClass":"removeClass"]("ui-state-disabled"),this.element.attr({disabled:b,"aria-disabled":b})},open:function(){var b=this,c=this.button,d=this.menu,e=this.speed,f=this.options,g=[];if(this._trigger("beforeopen")!==!1&&!c.hasClass("ui-state-disabled")&&!this._isOpen){var h=d.find("ul").last(),i=f.show;a.isArray(f.show)&&(i=f.show[0],e=f.show[1]||b.speed),i&&(g=[i,e]),h.scrollTop(0).height(f.height),this.position(),a.fn.show.apply(d,g),this.labels.filter(":not(.ui-state-disabled)").eq(0).trigger("mouseover").trigger("mouseenter").find("input").trigger("focus"),c.addClass("ui-state-active"),this._isOpen=!0,this._trigger("open")}},close:function(){if(this._trigger("beforeclose")!==!1){var b=this.options,c=b.hide,d=this.speed,e=[];a.isArray(b.hide)&&(c=b.hide[0],d=b.hide[1]||this.speed),c&&(e=[c,d]),a.fn.hide.apply(this.menu,e),this.button.removeClass("ui-state-active").trigger("blur").trigger("mouseleave"),this._isOpen=!1,this._trigger("close")}},enable:function(){this._toggleDisabled(!1)},disable:function(){this._toggleDisabled(!0)},checkAll:function(){this._trigger("beforeCheckAll"),this._toggleChecked(!0),this._trigger("checkAll")},uncheckAll:function(){this._trigger("beforeUncheckAll"),this._toggleChecked(!1),this._trigger("uncheckAll")},getChecked:function(){return this.menu.find("input").filter(":checked")},destroy:function(){return a.Widget.prototype.destroy.call(this),c.unbind(this._namespaceID),this.button.remove(),this.menu.remove(),this.element.show(),this},isOpen:function(){return this._isOpen},widget:function(){return this.menu},getButton:function(){return this.button},position:function(){var b=this.options;if(a.ui.position&&!a.isEmptyObject(b.position))b.position.of=b.position.of||this.button,this.menu.show().position(b.position).hide();else{var c=this.button.offset(),d=c.top+("auto"===b.height?this.menu.height():b.height)+this.button.outerHeight();this.menu.css({top:d<a(window).height()?c.top+this.button.outerHeight():c.top-this.menu.outerHeight(),left:c.left})}},_setOption:function(b,c){var d=this.menu;switch(b){case"header":d.find("div.jselect-header")[c?"show":"hide"]();break;case"checkAllText":d.find("a.jselect-all span").eq(-1).text(c);break;case"uncheckAllText":d.find("a.jselect-none span").eq(-1).text(c);break;case"height":d.find("ul").last().height(parseInt(c,10));break;case"minWidth":this.options[b]=c,this._setButtonWidth(),this._setMenuWidth();break;case"menuWidth":this.options[b]=c,this._setMenuWidth();break;case"selectedText":case"selectedList":case"noneSelectedText":case"allSelectedText":this.options[b]=c,this.update();break;case"classes":d.add(this.button).removeClass(this.options.classes).addClass(c);break;case"multiple":d.toggleClass("jselect-single",!c),this.options.multiple=c,this.element[0].multiple=c,this.refresh();break;case"selectOnSpace":case"bShowAllSelectedText":this.options[b]=!!c;break;case"position":this.position()}a.Widget.prototype._setOption.apply(this,arguments)}})}(jQuery);